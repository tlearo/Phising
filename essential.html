<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Match each ASD Essential Eight strategy to its description. Earn your vault digit in Cyber Escape Rooms." />
  <link rel="icon" href="assets/favicon.png" type="image/png" />

  <!-- Tight CSP (local assets only) -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 img-src 'self' data:;
                 style-src 'self' 'unsafe-inline';
                 script-src 'self';
                 connect-src 'self';
                 object-src 'none';
                 base-uri 'self'">

  <title>Cyber Escape Rooms — ASD Essentials</title>

  <!-- External files only -->
  <link rel="stylesheet" href="css/styles.css" />
  <script src="js/accessibility.js" defer></script>
  <script src="js/utils.js" defer></script>
  <script src="js/state-sync.js" defer></script>
  <script src="js/session.js" defer></script>
  <script src="js/vault.js" defer></script>
  <script src="js/onboarding.js" defer></script>
  <script src="js/dragdrop.js" defer></script>
</head>

<body data-session="team">
  <a class="skip-link" href="#main">Skip to content</a>

  <!-- Global Header -->
  <header class="site-header site-header--bar" aria-label="Global">
    <div class="site-header__inner">
      <div class="header-left">
        <button class="nav-btn ghost nav-btn--back" type="button" data-back="game.html" data-tooltip="Back to previous page">
          <span aria-hidden="true">←</span>
          <span>Back</span>
        </button>
        <a class="brand" href="game.html">
          <img src="assets/logo.png" alt="" class="logo" />
          <span class="brand-copy">
            <span class="brand-name">Cyber Escape Rooms</span>
            <span class="brand-tagline">Team-based security missions</span>
          </span>
        </a>
      </div>

      <div class="header-actions">
        <nav class="main-nav" aria-label="Primary">
          <a class="nav-link" href="game.html">Mission Hub</a>
        </nav>
        <a class="nav-btn nav-btn--next" href="binary.html" aria-label="Next challenge: Binary Lab">
          Next<span aria-hidden="true">→</span>
        </a>
        <div class="vault-status" id="vaultStatus" role="status" aria-live="polite" data-visible="team">
          <span class="vault-status__label">Vault</span>
          <ol class="vault-status__digits">
            <li data-vault-key="phishing">•</li>
            <li data-vault-key="encryption">•</li>
            <li data-vault-key="password">•</li>
            <li data-vault-key="essential">•</li>
            <li data-vault-key="binary">•</li>
          </ol>
          <span class="vault-status__count">0/5</span>
        </div>
        <button class="nav-btn alert nav-btn--logout" type="button" data-action="logout">Logout</button>
      </div>
    </div>
  </header>

  <main class="container" id="main" role="main" tabindex="-1">
    <header class="game-header">
      <h1 class="glow">ASD Essentials</h1>
      <p class="mt-1" style="color:var(--muted)">Drag each control to the matching description. Get them all right to earn your digit.</p>
      <div class="puzzle-actions mt-1">
        <button class="btn ghost sm onboard-trigger" type="button" data-onboard="onboard-essential">How to play</button>
      </div>
    </header>

    <section class="intro-banner points-card mt-2" aria-labelledby="essentialPointsHeading">
      <details class="points-panel" open>
        <summary id="essentialPointsHeading">Points intel</summary>
        <p>Momentum matters less than accuracy. Every correct placement locks in your score; each incorrect check costs time and focus.</p>
        <ul>
          <li>Watch the progress bar—aim for a full green track before pressing <strong>Check</strong>.</li>
          <li>Hints cost 5 points and highlight strategy families instead of answers.</li>
          <li>Digit four is always the count of ASD Essential Eight strategies, but you must still earn it with a perfect board.</li>
        </ul>
      </details>
      <div class="vault-callout" role="status">
        <span class="tag">Vault digit</span>
        <p><strong id="essentialVaultValue">—</strong> ASD Essential Eight strategies — complete the set before claiming the digit.</p>
      </div>
    </section>

    <aside class="card tip-card mt-2" aria-labelledby="essentialTipHeading">
      <h2 id="essentialTipHeading">Mission tip</h2>
      <p class="muted">Each mitigation can only be used once. Read the “Impact” cue before dropping—any leftover strategy gives you the vault digit.</p>
    </aside>

    <section class="status-hud" aria-label="Team status">
      <div class="points-box">
        <p class="points-box__label">Team points</p>
        <p class="points-box__value" id="essentialPointsTotal">000</p>
        <p class="points-box__delta" id="essentialPointsDelta" aria-live="polite"></p>
      </div>
      <div class="progress-mini">
        <p class="progress-mini__label">Puzzle progress</p>
        <div class="progress-mini__track">
          <div class="progress-mini__fill" id="essentialProgressFill"></div>
        </div>
        <p class="progress-mini__text" id="essentialProgressText">0% complete</p>
      </div>
    </section>

    <!-- Two-column layout -->
    <section class="ess-layout mt-2">
      <!-- LEFT: draggable controls -->
      <aside class="ess-column" aria-label="Controls to drag">
        <h2>Controls</h2>
        <ul id="dragList" class="drag-list" aria-describedby="dragHelp">
          <!-- Cards populated by JS if needed; include defaults for accessibility -->
          <li class="drag-card" draggable="true" tabindex="0" data-key="app-control">
            <span class="dot" style="background:#86efac;"></span>
            Application control (allow-listing)
          </li>
          <li class="drag-card" draggable="true" tabindex="0" data-key="patch-apps">
            <span class="dot" style="background:#a5b4fc;"></span>
            Patch applications
          </li>
          <li class="drag-card" draggable="true" tabindex="0" data-key="macro-settings">
            <span class="dot" style="background:#fca5a5;"></span>
            Configure MS Office macro settings
          </li>
          <li class="drag-card" draggable="true" tabindex="0" data-key="user-hardening">
            <span class="dot" style="background:#fdba74;"></span>
            User application hardening
          </li>
          <li class="drag-card" draggable="true" tabindex="0" data-key="restrict-admin">
            <span class="dot" style="background:#93c5fd;"></span>
            Restrict administrative privileges
          </li>
          <li class="drag-card" draggable="true" tabindex="0" data-key="patch-os">
            <span class="dot" style="background:#fcd34d;"></span>
            Patch operating systems
          </li>
          <li class="drag-card" draggable="true" tabindex="0" data-key="mfa">
            <span class="dot" style="background:#f472b6;"></span>
            Multi-factor authentication
          </li>
          <li class="drag-card" draggable="true" tabindex="0" data-key="backups">
            <span class="dot" style="background:#60a5fa;"></span>
            Regular backups
          </li>
        </ul>
        <p id="dragHelp" class="mt-1" style="color:var(--muted)">Drag a card to a matching slot on the right.</p>

        <div class="flex mt-2">
          <button class="btn" id="checkAnswersBtn" data-tooltip="Check current placements">Check</button>
          <button class="btn ghost" id="shuffleBtn">Shuffle</button>
          <button class="btn warn" id="resetBoardBtn" data-tooltip="Reset the board">Reset</button>
          <button class="btn ghost" id="essHintBtn" type="button">Hint (−5 pts)</button>
        </div>

        <!-- Progress bar -->
        <div class="ess-progress mt-2" aria-label="Puzzle progress">
          <div class="progress-bar">
            <div id="progressFill"></div>
          </div>
          <p class="mt-1" id="essProgressText" aria-live="polite" style="color:var(--muted)">0/8 correct</p>
        </div>

        <p id="essFeedback" class="mt-2" aria-live="polite"></p>
        <p id="essHintText" class="hint-callout" hidden>Group the controls by purpose: prevent, limit, detect, and recover. Matching that intent to the description is key.</p>
      </aside>

      <!-- RIGHT: drop targets / descriptions -->
      <section class="ess-column" aria-label="Descriptions">
        <h2>Descriptions</h2>
        <ul id="dropList" class="drop-list">
          <li class="drop-slot" data-slot="app-control" tabindex="0">
            <div class="slot-head">
              <span class="dot"></span>
              <strong>Only approved executables should run</strong>
            </div>
            <p class="slot-desc">Lock workstations so unknown software cannot launch without being explicitly approved.</p>
            <div class="slot-bay" aria-live="polite"></div>
          </li>

          <li class="drop-slot" data-slot="patch-apps" tabindex="0">
            <div class="slot-head">
              <span class="dot"></span>
              <strong>Keep apps up to date</strong>
            </div>
            <p class="slot-desc">Close the gaps attackers exploit by updating user-facing apps within the vendor’s patch window.</p>
            <div class="slot-bay" aria-live="polite"></div>
          </li>

          <li class="drop-slot" data-slot="macro-settings" tabindex="0">
            <div class="slot-head">
              <span class="dot"></span>
              <strong>Block risky macros</strong>
            </div>
            <p class="slot-desc">Treat downloaded documents as hostile unless their automation comes from trusted, signed sources.</p>
            <div class="slot-bay" aria-live="polite"></div>
          </li>

          <li class="drop-slot" data-slot="user-hardening" tabindex="0">
            <div class="slot-head">
              <span class="dot"></span>
              <strong>Harden user-facing apps</strong>
            </div>
            <p class="slot-desc">Strip away risky plug-ins and defaults in browsers and document viewers to shrink the attack surface.</p>
            <div class="slot-bay" aria-live="polite"></div>
          </li>

          <li class="drop-slot" data-slot="restrict-admin" tabindex="0">
            <div class="slot-head">
              <span class="dot"></span>
              <strong>Least privilege</strong>
            </div>
            <p class="slot-desc">Use standard accounts day to day; reserve privileged credentials for controlled maintenance with monitoring.</p>
            <div class="slot-bay" aria-live="polite"></div>
          </li>

          <li class="drop-slot" data-slot="patch-os" tabindex="0">
            <div class="slot-head">
              <span class="dot"></span>
              <strong>OS patching</strong>
            </div>
            <p class="slot-desc">Keep every operating system on the current security baseline across workstations, servers, and mobiles.</p>
            <div class="slot-bay" aria-live="polite"></div>
          </li>

          <li class="drop-slot" data-slot="mfa" tabindex="0">
            <div class="slot-head">
              <span class="dot"></span>
              <strong>Require MFA</strong>
            </div>
            <p class="slot-desc">Require a second factor for high-value logins, especially remote access and privileged roles.</p>
            <div class="slot-bay" aria-live="polite"></div>
          </li>

          <li class="drop-slot" data-slot="backups" tabindex="0">
            <div class="slot-head">
              <span class="dot"></span>
              <strong>Back up and test restores</strong>
            </div>
            <p class="slot-desc">Maintain offline or immutable backups and rehearse restorations so ransomware cannot pin you down.</p>
            <div class="slot-bay" aria-live="polite"></div>
          </li>
        </ul>

        <div class="mt-2">
          <a href="game.html" class="btn ghost">Back to Vault</a>
          <a href="index.html" class="btn">Home</a>
        </div>
      </section>

      <!-- Decorative wires SVG (optional, styled in CSS) -->
      <svg class="ess-wires" viewBox="0 0 1200 600" aria-hidden="true">
        <path class="wire" d="M40 80 C 220 140, 380 40, 560 100 S 900 180, 1160 120" />
        <path class="wire" d="M40 220 C 220 260, 380 200, 560 260 S 900 320, 1160 260" />
        <path class="wire" d="M40 380 C 220 420, 380 360, 560 420 S 900 480, 1160 420" />
      </svg>
    </section>

    <section class="card resources-card mt-2" aria-labelledby="essentialResourcesHeading">
      <h2 id="essentialResourcesHeading">Further learning</h2>
      <ul>
        <li><a href="https://www.cyber.gov.au/resources-business-and-government/strategies/prevent-cyber-security-incidents/essential-eight" target="_blank" rel="noopener">ACSC — ASD Essential Eight guidance</a></li>
        <li><a href="https://www.cisa.gov/secure-by-design" target="_blank" rel="noopener">CISA — Secure by Design principles</a></li>
        <li><a href="https://learn.microsoft.com/en-us/security/compass/essential-eight" target="_blank" rel="noopener">Microsoft — ASD Essential Eight deployment</a></li>
      </ul>
    </section>

    <nav class="challenge-nav" aria-label="Puzzle navigation">
      <a class="btn ghost" href="encryption.html">&larr; Previous: Encryption</a>
      <a class="btn" href="binary.html">Next: Binary Lab &rarr;</a>
    </nav>

    <footer class="mt-3">
      <p style="color:var(--muted)">Pro tip: read carefully — several controls sound similar but have distinct goals.</p>
    </footer>
  </main>

  <div class="onboard" id="onboard-essential" hidden data-onboard-key="essential" data-onboard-auto="true" aria-labelledby="onboardEssentialTitle">
    <div class="onboard__backdrop" data-onboard-close></div>
    <div class="onboard__dialog">
      <button class="onboard__close" type="button" aria-label="Close tutorial" data-onboard-close>&times;</button>
      <h2 id="onboardEssentialTitle" data-onboard-focus>ASD Essentials — Quick Guide</h2>
      <p>Digit four is locked at eight, but you still need a perfect board to earn it.</p>
      <ol class="onboard__list">
        <li>Drag each control to the matching description or use keyboard focus with Enter/Space.</li>
        <li>Use the progress bar to see how many placements are correct before checking.</li>
        <li>Press Check to confirm, then note digit eight for the vault once the board is perfect.</li>
      </ol>
    </div>
  </div>

  <!-- Global Footer -->
  <footer class="site-footer header-bleed">
    <div class="footer-inner">
      <nav class="footer-nav" aria-label="Footer">
        <a href="index.html">Home</a>
        <span aria-hidden="true">•</span>
        <a href="game.html">Mission Hub</a>
        <span aria-hidden="true">•</span>
      </nav>
      <p class="footer-note">Match every ASD Essential Eight control to lock in your fourth digit.</p>
      <p class="footer-copy"><small>&copy; 2025 Cyber Escape Rooms</small></p>
    </div>
  </footer>
</body>
</html>
