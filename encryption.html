<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Decrypt the message using a Caesar wheel. Earn your digit for the final vault lock in Cyber Escape Rooms." />
  <link rel="icon" href="assets/favicon.png" type="image/png" />

  <!-- Tight CSP (local assets only) -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 img-src 'self' data:;
                 style-src 'self' 'unsafe-inline';
                 script-src 'self';
                 connect-src 'self';
                 object-src 'none';
                 base-uri 'self';
                 frame-ancestors 'none'">

  <title>Cyber Escape Rooms — Encryption</title>

  <!-- External files only -->
  <link rel="stylesheet" href="css/styles.css" />
  <script src="js/accessibility.js" defer></script>
  <script src="js/utils.js" defer></script>
  <script src="js/encryption.js" defer></script>
</head>

<body>
  <a class="skip-link" href="#main">Skip to content</a>

  <!-- Global Header: classic website bar -->
  <header class="site-header site-header--bar" aria-label="Global">
    <div class="site-header__inner">
      <a class="brand" href="index.html">
        <img src="assets/logo.png" alt="" class="logo" />
        <span class="brand-name">Cyber Escape Rooms</span>
      </a>

      <nav class="main-nav" aria-label="Primary">
        <a class="nav-link" href="#" onclick="utils.backOrHome();return false;">Back</a>
        <a class="nav-link" href="index.html">Home</a>
        <a class="nav-link" href="game.html">Game</a>
        <a class="nav-link" href="admin.html">Admin</a>
      </nav>
    </div>
  </header>

  <main class="container" id="main" role="main" tabindex="-1">
    <header class="game-header">
      <h1 class="glow">Encryption</h1>
      <p class="mt-1" style="color:var(--muted)">Use the Caesar wheel to decode the message. Submit the plaintext to earn your digit.</p>
    </header>

    <!-- Two-column responsive layout -->
    <section class="enc-layout mt-2">
      <!-- LEFT: Wheel & controls -->
      <aside class="enc-wheel-panel card" aria-label="Caesar wheel controls">
        <!-- Fixed-size wheel viewport -->
        <div id="wheelWrap" class="wheel-wrap">
          <!-- OUTER: plaintext A–Z (upright) -->
          <div id="outerRing" class="wheel outer" aria-hidden="true"></div>
          <!-- INNER: cipher a–z (rotates) -->
          <div id="innerRing" class="wheel inner"
               role="slider" aria-label="Shift amount"
               aria-valuemin="0" aria-valuemax="25" aria-valuenow="0"
               tabindex="0"></div>
        </div>

        <div class="flex" aria-label="Shift controls">
          <button id="shiftDown" class="btn sm" type="button" aria-label="Decrease shift">−</button>
          <input id="shiftSlider" type="range" min="0" max="25" value="0" aria-label="Shift slider" />
          <button id="shiftUp" class="btn sm" type="button" aria-label="Increase shift">+</button>
          <span class="mt-1" aria-live="polite">Shift: <strong id="shiftValue">0</strong></span>
        </div>
      </aside>

      <!-- RIGHT: Cipher, live output, submit -->
      <section class="enc-panel card" aria-label="Decryption workspace">
        <h2>Decrypt This</h2>

        <div class="mt-1">
          <p class="muted">Ciphertext:</p>
          <div class="card sm mt-1" style="overflow:auto">
            <code id="cipherText">—</code>
          </div>
        </div>

        <div class="mt-2">
          <p class="muted">Live output (based on current shift):</p>
          <div class="card sm mt-1" style="overflow:auto">
            <div id="liveOutput" aria-live="polite">Rotate the inner ring or use the slider.</div>
          </div>
        </div>

        <div class="mt-2 field">
          <label for="finalAnswer">Type the final plaintext (exact spelling):</label>
          <input id="finalAnswer" type="text" autocomplete="off" />
        </div>

        <div class="flex mt-2">
          <button id="submitBtn" class="btn" type="button">Submit</button>
          <a href="game.html" class="btn ghost">Back to Vault</a>
          <a href="index.html" class="btn">Home</a>
        </div>

        <p id="encFeedback" class="mt-2" aria-live="polite"></p>
      </section>
    </section>

    <footer class="mt-3">
      <p style="color:var(--muted)">Tip: the inner ring rotates; align letters to reveal the plaintext.</p>
    </footer>
  </main>

  <!-- Global Footer -->
  <footer class="site-footer header-bleed">
    <nav class="footer-nav">
      <a href="index.html">Home</a>
      <span aria-hidden="true">•</span>
      <a href="game.html">Game</a>
      <span aria-hidden="true">•</span>
      <a href="admin.html">Admin</a>
    </nav>
    <p><small>&copy; 2025 Cyber Escape Rooms</small></p>
  </footer>
</body>
</html>
