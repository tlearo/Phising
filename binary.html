<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Work through XOR logic and binary multiplication to earn your vault digit in Cyber Escape Rooms." />
  <link rel="icon" href="assets/favicon.png" type="image/png" />

  <!-- Tight CSP (local assets only) -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 img-src 'self' data:;
                 style-src 'self' 'unsafe-inline';
                 script-src 'self';
                 connect-src 'self';
                 object-src 'none';
                 base-uri 'self';
                 frame-ancestors 'none'">

  <title>Cyber Escape Rooms — Binary Lab</title>

  <!-- External files only -->
  <link rel="stylesheet" href="css/styles.css" />
  <script src="js/accessibility.js" defer></script>
  <script src="js/utils.js" defer></script>
  <script src="js/state-sync.js" defer></script>
  <script src="js/session.js" defer></script>
  <script src="js/vault.js" defer></script>
  <script src="js/onboarding.js" defer></script>
  <script src="js/binary.js" defer></script>
</head>

<body data-session="team">
  <a class="skip-link" href="#main">Skip to content</a>

  <!-- Global Header -->
  <header class="site-header site-header--bar" aria-label="Global">
    <div class="site-header__inner">
      <div class="header-left">
        <button class="nav-btn ghost nav-btn--back" type="button" data-back="game.html" data-tooltip="Back to previous page">
          <span aria-hidden="true">←</span>
          <span>Back</span>
        </button>
        <a class="brand" href="game.html">
          <img src="assets/logo.png" alt="" class="logo" />
          <span class="brand-copy">
            <span class="brand-name">Cyber Escape Rooms</span>
            <span class="brand-tagline">Team-based security missions</span>
          </span>
        </a>
      </div>

      <div class="header-actions">
        <nav class="main-nav" aria-label="Primary">
          <a class="nav-link" href="game.html">Mission Hub</a>
          <a class="nav-link" href="admin.html" data-role="admin-link" data-visible="admin" hidden aria-hidden="true">Admin</a>
        </nav>
        <div class="vault-status" id="vaultStatus" role="status" aria-live="polite" data-visible="team">
          <span class="vault-status__label">Vault</span>
          <ol class="vault-status__digits">
            <li data-vault-key="phishing">•</li>
            <li data-vault-key="encryption">•</li>
            <li data-vault-key="password">•</li>
            <li data-vault-key="essential">•</li>
            <li data-vault-key="binary">•</li>
          </ol>
          <span class="vault-status__count">0/5</span>
        </div>
        <button class="nav-btn alert nav-btn--logout" type="button" data-action="logout">Logout</button>
      </div>
    </div>
  </header>

  <main class="container" id="main" role="main" tabindex="-1">
    <header class="game-header">
      <h1 class="glow">Binary Operations Lab</h1>
      <p class="mt-1" style="color:var(--muted)">Compare bits with XOR, multiply the values, and capture the vault digit from the decimal result.</p>
      <div class="puzzle-actions mt-1">
        <button class="btn ghost sm onboard-trigger" type="button" data-onboard="onboard-binary">How to play</button>
      </div>
    </header>

    <section class="intro-banner mt-2" aria-labelledby="binaryBriefHeading">
      <h2 id="binaryBriefHeading">Points reminder</h2>
      <p>Binary math rewards precision. Correct conversions keep your score intact; typos or guesses lead to rechecks and deductions. Calculate carefully, double-check place values, then submit once.</p>
      <ul>
        <li>The vault digit is the decimal value of the XOR row (1101 ⊕ 1011 = 6).</li>
        <li>Status pills update as you confirm each step; don’t move on until they glow green.</li>
        <li>Use the crack-time calculator or scratch space before entering answers to avoid point hits.</li>
        <li>Hints are available, but they cost points—save them for when you are truly stuck.</li>
      </ul>
      <div class="vault-callout" role="status">
        <span class="tag">Vault digit</span>
        <p>Record the decimal XOR result. When you finish the table, capture <strong id="binaryVaultDigit">—</strong>.</p>
      </div>
    </section>

    <aside class="card tip-card mt-2" aria-labelledby="binaryTipHeading">
      <h2 id="binaryTipHeading">Mission tip</h2>
      <p class="muted">Map every column to its place value first, then convert each binary row to decimal and finish with the XOR digit.</p>
    </aside>

    <section class="status-hud" aria-label="Team status">
      <div class="points-box">
        <p class="points-box__label">Team points</p>
        <p class="points-box__value" id="binaryPointsTotal">000</p>
        <p class="points-box__delta" id="binaryPointsDelta" aria-live="polite"></p>
      </div>
      <div class="progress-mini">
        <p class="progress-mini__label">Puzzle progress</p>
        <div class="progress-mini__track">
          <div class="progress-mini__fill" id="binaryProgressFill"></div>
        </div>
        <p class="progress-mini__text" id="binaryProgressText">0% complete</p>
      </div>
    </section>

    <section class="binary-layout mt-2">
      <section class="card binary-challenge" aria-labelledby="binaryChallengeHeading">
        <h2 id="binaryChallengeHeading">Compute &amp; Combine</h2>
        <p class="mt-1">Two binary strings power this lock. Complete the table to prove you understand both XOR and binary multiplication.</p>

        <div class="binary-meta mt-2" role="group" aria-label="Given binary values">
          <div class="meta-item">
            <h3>Binary A</h3>
            <code id="binaryA">1101</code>
          </div>
          <div class="meta-item">
            <h3>Binary B</h3>
            <code id="binaryB">1011</code>
          </div>
        </div>

        <table id="binaryInputTable" class="binary-table binary-input-table mt-2" aria-describedby="binaryHint"></table>

        <div class="binary-sum-grid mt-2" aria-live="polite">
          <p class="binary-sum" id="binarySumA">Binary A contributions: —</p>
          <p class="binary-sum" id="binarySumB">Binary B contributions: —</p>
          <p class="binary-sum" id="binarySumXor">XOR contributions: —</p>
        </div>
        <p class="muted mt-1">Example: 1101 means 1×8 + 1×4 + 0×2 + 1×1 = 13.</p>

        <p id="binaryHint" class="muted mt-1">Tip: XOR outputs 1 where the bits differ and 0 where they match. 1 ⊕ 1 = 0, 1 ⊕ 0 = 1, 0 ⊕ 0 = 0.</p>

        <div class="binary-status mt-2" aria-live="polite">
          <span class="status-pill" id="valueAStatus">Decimal A pending</span>
          <span class="status-pill" id="valueBStatus">Decimal B pending</span>
          <span class="status-pill" id="xorStatus">XOR pending</span>
        </div>

        <div class="binary-result-grid mt-2">
          <label class="result-field" for="decAInput">
            <span>Binary A in decimal</span>
            <input id="decAInput" name="decAInput" type="number" inputmode="numeric" autocomplete="off" placeholder="13" aria-label="Decimal value of Binary A" />
          </label>
          <label class="result-field" for="decBInput">
            <span>Binary B in decimal</span>
            <input id="decBInput" name="decBInput" type="number" inputmode="numeric" autocomplete="off" placeholder="11" aria-label="Decimal value of Binary B" />
          </label>
          <label class="result-field" for="xorDec">
            <span>Decimal XOR (vault digit)</span>
            <input id="xorDec" name="xorDec" type="number" inputmode="numeric" autocomplete="off" placeholder="6" aria-label="Decimal XOR of A and B" />
          </label>
        </div>

        <div class="flex mt-2" style="gap:.75rem; flex-wrap:wrap;">
          <button class="btn" type="button" id="binaryCheck" data-tooltip="Check your entries">Check answers</button>
          <button class="btn ghost" type="button" id="binaryReset" data-tooltip="Clear inputs">Reset</button>
          <button class="btn ghost" type="button" id="binaryHintBtn">Hint (−5 pts)</button>
        </div>

        <p class="feedback mt-2" id="binaryFeedback" aria-live="polite"></p>
        <p class="muted mt-1" id="binaryChestHint" hidden>Your vault digit equals the decimal XOR result.</p>
        <p id="binaryHintText" class="hint-callout" hidden>Line up the digits under matching place values, convert each binary row to decimal, then compute the XOR row. Record the XOR decimal as your vault digit.</p>
      </section>

      <section class="card binary-place" aria-labelledby="binaryPlaceHeading">
        <h2 id="binaryPlaceHeading">Place Values</h2>
        <p class="muted">1 means the value is <strong>on</strong> (include it); 0 means it is <strong>off</strong> (ignore it). Use this map to convert binary to decimal.</p>
        <table class="binary-place-table" id="binaryPlaceTable"></table>
      </section>

      <section class="card binary-xor" aria-labelledby="xorHeading">
        <h2 id="xorHeading">Why XOR Matters</h2>
        <p class="mt-1">Exclusive OR (XOR) is the Swiss army knife of bitwise operations:</p>
        <ul class="mt-1">
          <li>It flags every bit-flip between two values, making differences easy to spot.</li>
          <li>It powers parity checks and error detection in network packets.</li>
          <li>It forms the backbone of many stream ciphers and one-time pads.</li>
        </ul>
        <p class="mt-1">In this lab, XOR warms you up before you convert the binary values to decimal. Once all three decimals are confirmed, the XOR value becomes your vault digit.</p>
      </section>

      <section class="card binary-guide" aria-labelledby="binaryGuideHeading">
        <h2 id="binaryGuideHeading">Binary Coach</h2>
        <ol class="mt-1">
          <li>Read Binary A and Binary B from the table; use the place-value chart to convert them to decimal.</li>
          <li>Fill the XOR row so every differing bit becomes 1, then convert that binary result to decimal.</li>
          <li>Vault digit = decimal XOR result. Example: 1101 ⊕ 1011 = 0110 → <strong>6</strong>.</li>
        </ol>
        <p class="muted mt-1">Need a reminder? The place-value table on the right shows why 1s matter in specific columns.</p>
      </section>
    </section>

    <section class="card resources-card mt-2" aria-labelledby="binaryResourcesHeading">
      <h2 id="binaryResourcesHeading">Further learning</h2>
      <ul>
        <li><a href="https://www.khanacademy.org/computing/computer-science/cryptography/ciphers/a/binary-number-system" target="_blank" rel="noopener">Khan Academy — Binary number system</a></li>
        <li><a href="https://www.csfieldguide.org.nz/en/chapters/representing-data/binary-numbers/" target="_blank" rel="noopener">CS Field Guide — Binary numbers</a></li>
        <li><a href="https://www.geeksforgeeks.org/binary-multiplication/" target="_blank" rel="noopener">GeeksforGeeks — Binary multiplication</a></li>
      </ul>
    </section>

    <nav class="challenge-nav" aria-label="Puzzle navigation">
      <a class="btn ghost" href="essential.html">&larr; Previous: Essential Eight</a>
      <a class="btn" href="game.html">Next: Mission Hub &rarr;</a>
    </nav>
  </main>

  <div class="onboard" id="onboard-binary" hidden data-onboard-key="binary" data-onboard-auto="true" aria-labelledby="onboardBinaryTitle">
    <div class="onboard__backdrop" data-onboard-close></div>
    <div class="onboard__dialog">
      <button class="onboard__close" type="button" aria-label="Close tutorial" data-onboard-close>&times;</button>
      <h2 id="onboardBinaryTitle" data-onboard-focus>Binary Lab — Quick Guide</h2>
      <p>The vault digit is the decimal XOR value once your conversions are correct.</p>
      <ol class="onboard__list">
        <li>Translate Binary A and Binary B into decimal using the place-value chart.</li>
        <li>Fill the XOR row, then convert that binary result into decimal.</li>
        <li>Press Check—when all three pills glow green, record the XOR decimal for the vault.</li>
      </ol>
    </div>
  </div>

  <!-- Global Footer -->
  <footer class="site-footer header-bleed">
    <div class="footer-inner">
      <nav class="footer-nav" aria-label="Footer">
        <a href="index.html">Home</a>
        <span aria-hidden="true">•</span>
        <a href="game.html">Mission Hub</a>
        <span aria-hidden="true">•</span>
        <a href="admin.html" data-role="admin-link" data-visible="admin" hidden aria-hidden="true">Admin</a>
      </nav>
      <p class="footer-note">Convert both binaries, crush the XOR, and the vault digit reveals itself.</p>
      <p class="footer-copy"><small>&copy; 2025 Cyber Escape Rooms</small></p>
    </div>
  </footer>
</body>
</html>
